<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.2 on Wed Jul 10 18:24:44 2019 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>collision__define.pro (API Documentation for proEQUIB)</title>

    

    <script type="text/javascript" src="idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="idldoc-resources/js/copybutton.js"></script>

    
    <style type="text/css" media="all">
            /* setup page */
      body { font-family: Helvetica, sans-serif; font-size: 12pt; margin: 0; padding: 0; }
      div.content { padding: 1em; }
      p { line-height: 1.4; }
      td p { padding-bottom: 0.5em; }
      img { border: 0; }
      
      /* link styles */
      a { text-decoration: none; }
      a:link, a:visited { color: #0000FF; }
      a:hover, a:focus { background: yellow; border-bottom: 1emx dotted #303099; }
      
      /* dir-overview styles */
      dt.filename { margin-top: 0.5em; }
      dl.file_listing { margin-left: 1em; }
      
      /* titles */
      h1, h2, h3, h4 { font-weight:normal; color: #871E31; margin-top: 1.5em; }
      h4 { margin-bottom: 0.25em; }
      .center { margin-left: auto; margin-right: auto; }
      .small { font-family: Verdana, Helvetica, sans-serif; font-size: 90%; }
      .smaller { font-family: Verdana, Helvetica, sans-serif; font-size: 80%; }
      .smallest { font-family: Verdana, Helvetica, sans-serif; font-size: 70%; }
      h1.basename { margin-top: 0; margin-bottom: 0; }
      h1.basename span.file-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      h2.directory { font-size: 90%; margin-bottom: 0; }
      h2.routine-name { margin-top: 0; margin-bottom: 0; }
      p.categories { color: #384806; margin-top: 0; }
      span.file_attribute { float: right; color: #384806; margin: 0 0 1em 3em; }
      div#file_comments { margin-top: 1em; }
      
      div.routine-details { border: 1px dotted #C0C0C0; margin-top: 1em; padding: 1em; }
      span.routine-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      div.details dt { color: #871E31; margin-left: 2em; }
      div.details dt span { color: #384806; margin-left: 2em; }
      div.details dd { margin: 0.5em 2em 1em 4em; }
      a.top {
        font-family: Verdana, Helvetica, sans-serif;
        font-size: 8pt;
        font-weight: bold;
        color: #5070ff;
        text-transform: uppercase;
        float: right;
        margin-left: 1em;
      }
      
      /* comments */
      .pre { white-space: pre; }
      
      /* code styles */
      code { font-family: Monaco, "Courier New", Courier, monospace; font-size: 95%; }
      code.listing { white-space: pre; display: block; margin: 0.75em 0 0.75em 0; padding: 0 3em 0 1em; line-height: 1.4em; }
      code.source { white-space: pre; display: block; }
      code.source span.comments { color: #408080; }
      .syntax { margin-top: 1em; margin-left: 1.5em; text-indent: -1.5em; }
      .var { font-style: italic; }
      .argument { } /* white-space: nowrap; does not work in Safari (and sometimes not even in Firefox) */
      
      dl.routine-summary dt { margin-bottom: 0.25em; }
      dl.routine-summary dd { margin-bottom: 0.5em; margin-left: 2em; }
      
      ul.inherited-method-summary { padding-left: 0em; margin-left: 0em; }
      
      /* general styles */
      ul li { list-style-type: none; }
      table { empty-cells: show; }
      thead { color: #871E31; }
      dd { margin-bottom: 0.35em; }
      input, textarea { background: #F3F6ED; border: #E1D6C6 1px solid; padding: 2px 1em 2px 0.5em; }
      input.text { background: #FFFFC0; }
      
      div.note { margin: 1em 2em 1em 2em; background: #EFEFEF; border: 1px #A0A0A0 dotted; padding: 0 1em 0 1em; }
      p.indent { margin-left: 2em; }
      
      /* An attribute table is a vertical list of name-value pairs. */
      table.box {
        background: #EFEFEF;
        border: 1px #A0A0A0 dotted;
        padding-top: 0.75em;
        padding-bottom: 0.75em;
      }
      table.attribute { padding-left: 0.75em; padding-right: 0.75em; }
      table td { vertical-align: top; }
      table.attribute p { margin: 0; }
      table td.name { font-style: normal; padding-right: 1.5em; }
      ul.fieldslist { padding-top: 0; color: #909090; }
      ul.fieldslist li { margin-bottom: 0.25em; }
      span.fieldname { color: #000000; }
      
      dl.attribute dt { color: #990000; }
      
      /* header/navbar styles */
      div.header { padding: 2em 2em 0 2em; background: #9E9D7B; border-bottom: 2px #262626 solid; }
      div.header h1 { color: white; margin:0; font-weight: normal; }
      div.header h2 { color: white; margin-top: 0; margin-bottom: 1em; font-weight: normal; font-style: italic; font-size: 100%; }
      table.navbar { background: #CCC097; margin: 0; padding: 0; border-bottom: 1px #262626 dotted; width: 100%; }
      table.navbar td { padding: 4px 0.5em 3px 0.5em; white-space: nowrap; vertical-align: top; }
      table.navbar td.flexible { width: 100%; text-align: right; padding-right: 1em; white-space: nowrap; }
      table.navbar td.selected { background: #262626; }
      table.navbar td.selected, table.navbar td.selected a { color: white; }
      table.navbar a:hover, table.navbar a:focus { background: inherit; border-bottom: 1px solid #303099; }
      p.localnavbar { text-align: right; margin: 0.2em 1em 0.2em 0.2em; padding: 0; }
      
      /* CSS graphics styles */
      div.box {
        margin-left: 0.25em;
        display: inline-block;
        width: 0.9em;
        height: 0.9em;
        vertical-align: -1px;
      }
      .red { background-color: #A00; }
      .orange { background-color: #F40; }
      .green { background-color: #480; }
      
      /* index styles */
      span.index_type { margin-left: 1em; }
      dl.index_listing dd { margin-bottom: 0.5em; margin-left: 2em; }
      dl.index_listing dd p { margin-top: 0.2em; margin-bottom: 0em; }
      
      /* search styles */
      fieldset { border: #ddd 1px solid; padding: 1em; margin-top: 3em; }
      legend { color: #871E31; font-size: 120%; }
      label { white-space: nowrap; }
      p.description { margin: 2em 2em 1em 2em; }
      form table td.name { vertical-align: middle; }
      
      /* footer styles */
      div.footer { padding: 0.5em 1em 0.5em 1em; background: #EFEFEF; border-top: 1px #A0A0A0 dotted; }
      div.footer table { width: 100%; }
      div.footer td.right { text-align: right; }

    </style>
    <style type="text/css" media="print">
            p.localnavbar { display: none; }
      
      div.header { background: white; }
      div.header h1 { color: black; }
      div.header h2 { color: black; }

    </style>
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="collision__define.pro (API Documentation for proEQUIB)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>API Documentation for proEQUIB</h1>
      <h2>IDL Library for Plasma Diagnostics and Abundance Analysis</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
    
        <td >Etc</td>
    
        <td >
          <a href="categories.html">Categories</a>
        </td>
    
        <td >
          <a href="search.html">Search</a>
        </td>
    
        
        <td >
          <a href="idldoc-index.html">Index</a>
        </td>
        
    
        
        <td >
          <a href="idldoc-warnings.html">Warnings</a>
        </td>
        
    
        <td >
          <a href="idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          Developer documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">./</h2>
      <h1 class="basename">collision__define.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      
      <div class="class-description">
        <h2>Class description for collision</h2>

          
          <h3>Inheritance</h3>
            <ul>
              
              <li>ION_UNIT</li>
              
            </ul>

            
          

          

          

          
          <h3>Fields</h3>
            
            
              
              <h4>Fields in ION_UNIT</h4>
              <ul class="fieldslist smaller">
                
                <li><span class="fieldname">ATOM</span> ''</li>
                
                <li><span class="fieldname">BASE_DIR</span> ''</li>
                
                <li><span class="fieldname">ION</span> ''</li>
                
              </ul>
              
            
            

            
            <h4>Fields in collision</h4>
            <div class="details">
              <dl>
                
                <dt>ATOM_AIJ_FILE <span class="smaller">''</span></dt>
                <dd class="small"></dd>
                
                <dt>ATOM_ELJ_FILE <span class="smaller">''</span></dt>
                <dd class="small"></dd>
                
                <dt>ATOM_OMIJ_FILE <span class="smaller">''</span></dt>
                <dd class="small"></dd>
                
                <dt>ATOM_RC_SH95_FILE <span class="smaller">''</span></dt>
                <dd class="small"></dd>
                
                <dt>DATA_AIJ <span class="smaller">ptr_new()</span></dt>
                <dd class="small"></dd>
                
                <dt>DATA_DIR <span class="smaller">''</span></dt>
                <dd class="small"></dd>
                
                <dt>DATA_ELJ <span class="smaller">ptr_new()</span></dt>
                <dd class="small"></dd>
                
                <dt>DATA_OMIJ <span class="smaller">ptr_new()</span></dt>
                <dd class="small"></dd>
                
                <dt>DATA_RC_DIR <span class="smaller">''</span></dt>
                <dd class="small"></dd>
                
                <dt>HI_RC_DATA <span class="smaller">ptr_new()</span></dt>
                <dd class="small"></dd>
                
                <dt>LEVEL <span class="smaller">0L</span></dt>
                <dd class="small"></dd>
                
              </dl>
            </div>
            
          
      </div>
      

      
      <div>
        <h2>Routines</h2>
        

      
        
        
          

        
        
      

      
        <h3>Routines from collision__define.pro</h3>
        <dl class="routine-summary">
          
            <dt class="syntax"><a href="#collision::init"><code><span class="var">result</span> = collision::init()</code></a></dt>
            <dd class="small"><p>     "Unit for Collisionally Excited Lines":     This obejct library can be used     to determine electron temperature, electron density,     ionic abundance from the observed flux of collisionally     excited lines (CEL) for specified ion with level(s) by     solving atomic level populations and line emissivities     in statistical equilibrium for given electron density     and temperature.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::free"><code><span class="var">result</span> = collision::free()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::set"><code>collision::set<span class="argument">, atom_ion</span><span class="argument">, level=<span class="var">level</span></span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::calc_temperature"><code><span class="var">result</span> = collision::calc_temperature(<span class="argument">line_flux_ratio=<span class="var">float</span></span><span class="argument">, density=<span class="var">float</span></span><span class="argument">, upper_levels=<span class="var">string</span></span><span class="argument">, lower_levels=<span class="var">string</span></span><span class="argument"> [, low_temperature=<span class="var">float</span>]</span><span class="argument"> [, high_temperature=<span class="var">float</span>]</span><span class="argument"> [, num_temperature=<span class="var">integer</span>]</span><span class="argument"> [, min_density=<span class="var">float</span>]</span>)</code></a></dt>
            <dd class="small"><p>     This function determines electron temperature from given     flux intensity ratio for specified ion with upper level(s)     lower level(s) by solving atomic level populations and     line emissivities in statistical equilibrium     for given electron density.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::calc_density"><code><span class="var">result</span> = collision::calc_density(<span class="argument">line_flux_ratio=<span class="var">float</span></span><span class="argument">, temperature=<span class="var">float</span></span><span class="argument">, upper_levels=<span class="var">string</span></span><span class="argument">, lower_levels=<span class="var">string</span></span><span class="argument"> [, low_density=<span class="var">float</span>]</span><span class="argument"> [, high_density=<span class="var">float</span>]</span><span class="argument"> [, num_density=<span class="var">integer</span>]</span><span class="argument"> [, min_temperature=<span class="var">float</span>]</span>)</code></a></dt>
            <dd class="small"><p>     This function determines electron density from given     flux intensity ratio for specified ion with upper level(s)     lower level(s) by solving atomic level populations and     line emissivities in statistical equilibrium     for given electron temperature.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::calc_populations"><code><span class="var">result</span> = collision::calc_populations(<span class="argument">temperature=<span class="var">float</span></span><span class="argument">, density=<span class="var">float</span></span><span class="argument">, eff_Omij=<span class="var">array/object</span></span><span class="argument">, level_num=<span class="var">int</span></span><span class="argument">, irats=<span class="var">int</span></span>)</code></a></dt>
            <dd class="small"><p>     This function solves atomic level populations in statistical equilibrium     for given electron temperature and density.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::calc_crit_density"><code><span class="var">result</span> = collision::calc_crit_density(<span class="argument">temperature=<span class="var">float</span></span><span class="argument">, level_num=<span class="var">int</span></span><span class="argument">, irats=<span class="var">int</span></span>)</code></a></dt>
            <dd class="small"><p>     This function calculates critical densities in statistical equilibrium     for given electron temperature.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::calc_emissivity"><code><span class="var">result</span> = collision::calc_emissivity(<span class="argument">temperature=<span class="var">float</span></span><span class="argument">, density=<span class="var">float</span></span><span class="argument">, atomic_levels=<span class="var">string</span></span>)</code></a></dt>
            <dd class="small"><p>     This function calculates line emissivities for specified ion with level(s) by     solving atomic level populations and in statistical equilibrium     for given electron density and temperature.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::calc_abundance"><code><span class="var">result</span> = collision::calc_abundance(<span class="argument">temperature=<span class="var">float</span></span><span class="argument">, density=<span class="var">float</span></span><span class="argument">, line_flux=<span class="var">float</span></span><span class="argument">, atomic_levels=<span class="var">string</span></span>)</code></a></dt>
            <dd class="small"><p>     This function determines the ionic abundance from the observed     flux intensity for specified ion with level(s)     by solving atomic level populations and     line emissivities in statistical equilibrium     for given electron density and temperature.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::print_ionic"><code>collision::print_ionic<span class="argument">, temperature=<span class="var">float</span></span><span class="argument">, density=<span class="var">float</span></span><span class="argument">, /printEmissivity</span><span class="argument">, /printPopulations</span><span class="argument">, /printCritDensity</span></code></a></dt>
            <dd class="small"><p>    This function prints the atom's transitions information,    atomic level populations, critical densities, and emissivities    for given temperature and density.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::get_omij_temp"><code><span class="var">result</span> = collision::get_omij_temp(<span class="argument">temperature=<span class="var">float</span></span><span class="argument">, level_num=<span class="var">int</span></span><span class="argument">, irats=<span class="var">int</span></span>)</code></a></dt>
            <dd class="small"><p>     This function derives the effective collision strengths (Omij_T) from     the collision strengths (omega_ij) data for the given temperature.</p>

</dd>
          
            <dt class="syntax"><a href="#collision::set_level_num"><code>collision::set_level_num<span class="argument">, level_num</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::get_level_num"><code><span class="var">result</span> = collision::get_level_num()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::set_data_dir"><code>collision::set_data_dir<span class="argument">, data_dir</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::get_data_dir"><code><span class="var">result</span> = collision::get_data_dir()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::set_data_rc_dir"><code>collision::set_data_rc_dir<span class="argument">, data_rc_dir</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::get_data_rc_dir"><code><span class="var">result</span> = collision::get_data_rc_dir()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::set_Atom_Elj_file"><code>collision::set_Atom_Elj_file<span class="argument">, Atom_Elj_file</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::get_Atom_Elj_file"><code><span class="var">result</span> = collision::get_Atom_Elj_file()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::set_Atom_Omij_file"><code>collision::set_Atom_Omij_file<span class="argument">, Atom_Omij_file</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::get_Atom_Omij_file"><code><span class="var">result</span> = collision::get_Atom_Omij_file()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::set_Atom_Aij_file"><code>collision::set_Atom_Aij_file<span class="argument">, Atom_Aij_file</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::get_Atom_Aij_file"><code><span class="var">result</span> = collision::get_Atom_Aij_file()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::set_Atom_RC_SH95_file"><code>collision::set_Atom_RC_SH95_file<span class="argument">, Atom_RC_SH95_file</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision::get_Atom_RC_SH95_file"><code><span class="var">result</span> = collision::get_Atom_RC_SH95_file()</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#collision__define"><code>collision__define</code></a></dt>
            <dd class="small"></dd>
          
        </dl>
      

      
      </div>
      

      
      <div id="routine-details">
        <h2>Routine details</h2>

        
        <div class="routine-details details" id="collision::init">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::init<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Abundance Analysis, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::init()</code></p>

          
          <div ><p>     "Unit for Collisionally Excited Lines":
     This obejct library can be used
     to determine electron temperature, electron density,
     ionic abundance from the observed flux of collisionally
     excited lines (CEL) for specified ion with level(s) by
     solving atomic level populations and line emissivities
     in statistical equilibrium for given electron density
     and temperature.
</p>

<p></p>

</div>
          

          

          

          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> s2=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> s2-&gt;set,['s','ii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> upper_levels='1,2,1,3/'
<span class="code-prompt">IDL&gt;</span> lower_levels='1,5/'
<span class="code-prompt">IDL&gt;</span> density = double(2550)
<span class="code-prompt">IDL&gt;</span> line_flux_ratio=double(10.753)
<span class="code-prompt">IDL&gt;</span> temperature=s2-&gt;calc_temperature(line_flux_ratio=line_flux_ratio, density=density, $
<span class="code-prompt">IDL&gt;</span>   upper_levels=upper_levels, lower_levels=lower_levels)
<span class="code-prompt">IDL&gt;</span> print, "Electron Temperature:", temperature
<span class="code-output">   Electron Temperature:       7920.2865</span>

<span class="code-prompt">IDL&gt;</span> upper_levels='1,2/'
<span class="code-prompt">IDL&gt;</span> lower_levels='1,3/'
<span class="code-prompt">IDL&gt;</span> diagtype='D'
<span class="code-prompt">IDL&gt;</span> temperature=double(7000.0);
<span class="code-prompt">IDL&gt;</span> line_flux_ratio=double(1.506);
<span class="code-prompt">IDL&gt;</span> density=s2-&gt;calc_density(line_flux_ratio=line_flux_ratio, temperature=temperature, $
<span class="code-prompt">IDL&gt;</span>   upper_levels=upper_levels, lower_levels=lower_levels)
<span class="code-prompt">IDL&gt;</span> print, "Electron Density:", density
<span class="code-output">   Electron Density:       2312.6164</span>

<span class="code-prompt">IDL&gt;</span> density = double(1000)
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0);
<span class="code-prompt">IDL&gt;</span> Nlj=s2-&gt;calc_populations(temperature=temperature, density=density)
<span class="code-prompt">IDL&gt;</span> print, 'Atomic Level Populations:', Nlj
<span class="code-output">   Atomic Level Populations:      0.96992796    0.0070037404     0.023062517   2.6594158e-06   3.1277593e-06</span>

<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> N_crit=s2-&gt;calc_crit_density(temperature=temperature)
<span class="code-prompt">IDL&gt;</span> print, 'Critical Densities:', N_crit
<span class="code-output">   Critical Densities:       0.0000000       5007.8396       1732.8414       1072685.0       2220758.1</span>

<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> Omij_T=s2-&gt;get_omij_temp(temperature=temperature)
<span class="code-prompt">IDL&gt;</span> print, 'Effective Collision Strengths: '
<span class="code-prompt">IDL&gt;</span> print, Omij_T
<span class="code-output">   Effective Collision Strengths:</span>
<span class="code-output">   0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   2.7800000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   4.1600000       7.4600000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   1.1700000       1.8000000       2.2000000       0.0000000       0.0000000</span>
<span class="code-output">   2.3500000       3.0000000       4.9900000       2.7100000       0.0000000</span>

<span class="code-prompt">IDL&gt;</span> s2-&gt;print_ionic, temperature=temperature, density=density
<span class="code-output">   Temperature =   10000.0 K</span>
<span class="code-output">   Density =    1000.0 cm-3</span>

<span class="code-output">   Level    Populations   Critical Densities</span>
<span class="code-output">   Level 1:   9.699E-01   0.000E+00</span>
<span class="code-output">   Level 2:   7.004E-03   5.008E+03</span>
<span class="code-output">   Level 3:   2.306E-02   1.733E+03</span>
<span class="code-output">   Level 4:   2.659E-06   1.073E+06</span>
<span class="code-output">   Level 5:   3.128E-06   2.221E+06</span>

<span class="code-output">   1.231E-03</span>
<span class="code-output">   6732.69A</span>
<span class="code-output">   (2--&gt;1)</span>
<span class="code-output">   2.544E-20</span>

<span class="code-output">   3.338E-04   3.452E-07</span>
<span class="code-output">   6718.31A     314.47um</span>
<span class="code-output">   (3--&gt;1)     (3--&gt;2)</span>
<span class="code-output">   2.276E-20   5.029E-26</span>

<span class="code-output">   1.076E-01   1.812E-01   7.506E-02</span>
<span class="code-output">   4077.51A       1.03um       1.04um</span>
<span class="code-output">   (4--&gt;1)     (4--&gt;2)     (4--&gt;3)</span>
<span class="code-output">   1.394E-21   9.258E-22   3.823E-22</span>

<span class="code-output">   2.670E-01   1.644E-01   1.938E-01   0.000E+00</span>
<span class="code-output">   4069.76A       1.03um       1.03um     214.14um</span>
<span class="code-output">   (5--&gt;1)     (5--&gt;2)     (5--&gt;3)     (5--&gt;4)</span>
<span class="code-output">   4.076E-21   9.927E-22   1.166E-21   0.000E+00</span>

<span class="code-output">   H-beta emissivity: 1.237E-25 N(H+) Ne  [erg/s]</span>

<span class="code-prompt">IDL&gt;</span> o3=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> o3-&gt;set,['o','iii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> levels5007='3,4/'
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> density=double(5000.0)
<span class="code-prompt">IDL&gt;</span> iobs5007=double(1200.0)
<span class="code-prompt">IDL&gt;</span> Abb5007=double(0.0)
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> emis=o3-&gt;calc_emissivity(temperature=temperature, density=density, $
<span class="code-prompt">IDL&gt;</span>   atomic_levels=levels5007)
<span class="code-prompt">IDL&gt;</span> print, 'Emissivity(O III 5007):', emis
<span class="code-output">   Emissivity(O III 5007):   3.6041012e-21</span>

<span class="code-prompt">IDL&gt;</span> Abb5007=o3-&gt;calc_abundance(temperature=temperature, density=density, $
<span class="code-prompt">IDL&gt;</span>   line_flux=iobs5007, atomic_levels=levels5007)
<span class="code-prompt">IDL&gt;</span> print, 'N(O^2+)/N(H+):', Abb5007
<span class="code-output">   N(O^2+)/N(H+):   0.00041256231</span>

<span class="code-prompt">IDL&gt;</span> Nlj=o3-&gt;calc_populations(temperature=temperature, density=density)
<span class="code-prompt">IDL&gt;</span> print, 'Atomic Level Populations:', Nlj
<span class="code-output">   Atomic Level Populations:      0.15564960      0.42689831      0.41723001   0.00022205964   1.5224587e-08</span>

<span class="code-prompt">IDL&gt;</span> N_crit=o3-&gt;calc_crit_density(temperature=temperature)
<span class="code-prompt">IDL&gt;</span> print, 'Critical Densities:', N_crit
<span class="code-output">   Critical Densities:       0.0000000       490.78115       3419.4864       685276.77       25472367.</span>

<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> Omij_T=o3-&gt;get_omij_temp(temperature=temperature, level_num=8)
<span class="code-prompt">IDL&gt;</span> print, 'Effective Collision Strengths: '
<span class="code-prompt">IDL&gt;</span> print, Omij_T
<span class="code-output">   Effective Collision Strengths:</span>
<span class="code-output">   0.0000000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   0.54300000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   0.27000000       1.2900000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   0.25300000      0.76000000       1.2700000       0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   0.032300000     0.097200000      0.16200000      0.57800000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   0.13300000      0.39600000      0.66000000   1.9400000e-05       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   0.098800000       1.6300000      0.89000000      0.72700000    0.0029900000       1.4400000       0.0000000       0.0000000</span>
<span class="code-output">   0.66000000      0.62900000      0.28100000      0.29400000     0.024200000      0.46200000       1.0600000       0.0000000</span>

<span class="code-prompt">IDL&gt;</span> o3-&gt;print_ionic, temperature=temperature, density=density
<span class="code-output">   Temperature =   10000.0 K</span>
<span class="code-output">   Density =    5000.0 cm-3</span>

<span class="code-output">   Level    Populations   Critical Densities</span>
<span class="code-output">   Level 1:   1.556E-01   0.000E+00</span>
<span class="code-output">   Level 2:   4.269E-01   4.908E+02</span>
<span class="code-output">   Level 3:   4.172E-01   3.419E+03</span>
<span class="code-output">   Level 4:   2.221E-04   6.853E+05</span>
<span class="code-output">   Level 5:   1.522E-08   2.547E+07</span>

<span class="code-output">   2.597E-05</span>
<span class="code-output">   88.34um</span>
<span class="code-output">   (2--&gt;1)</span>
<span class="code-output">   4.986E-23</span>

<span class="code-output">   0.000E+00   9.632E-05</span>
<span class="code-output">   32.66um      51.81um</span>
<span class="code-output">   (3--&gt;1)     (3--&gt;2)</span>
<span class="code-output">   0.000E+00   3.081E-22</span>

<span class="code-output">   2.322E-06   6.791E-03   2.046E-02</span>
<span class="code-output">   4932.60A    4960.29A    5008.24A</span>
<span class="code-output">   (4--&gt;1)     (4--&gt;2)     (4--&gt;3)</span>
<span class="code-output">   4.153E-25   1.208E-21   3.604E-21</span>

<span class="code-output">   0.000E+00   2.255E-01   6.998E-04   1.685E+00</span>
<span class="code-output">   2315.58A    2321.67A    2332.12A    4364.45A</span>
<span class="code-output">   (5--&gt;1)     (5--&gt;2)     (5--&gt;3)     (5--&gt;4)</span>
<span class="code-output">   0.000E+00   5.875E-24   1.815E-26   2.335E-23</span>

<span class="code-output">   H-beta emissivity: 1.239E-25 N(H+) Ne  [erg/s]</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.
</p>

<p>     20/10/2016, A. Danehkar, Replaced str2int with strnumber.
</p>

<p>     20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with
          IDL function INTERPOL( /SPLINE).
</p>

<p>     20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function
                       LA_LINEAR_EQUATION.
</p>

<p>     15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)
           with IDL function LUDC & LUSOL.
</p>

<p>     19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with
                    SPL_INIT & SPL_INTERP.
</p>

<p>     20/11/2016, A. Danehkar, Made a new function calc_populations()
       for solving atomic level populations and separated it from
       calc_abundance(), calc_density() and calc_temperature().
</p>

<p>     21/11/2016, A. Danehkar, Made a new function calc_emissivity()
                      for calculating line emissivities and separated it
                      from calc_abundance().
</p>

<p>     10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data
                      input elj_data, omij_data, aij_data.
</p>

<p>     12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales
                        from calc_abundance(), calc_density(), and calc_temperature().
</p>

<p>     27/02/2019, A. Danehkar, Fix a bug in the atomic level assumption, and
                        use the simplified calc_populations() routine.
</p>

<p>     04/03/2019, A. Danehkar, Use the get_omij_temp() routine.
</p>

<p>     24/05/2019, A. Danehkar, Add the optional density range to calc_density(), and
                         the optional temperature range to calc_temperature().
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

<p> FORTRAN HISTORY:
</p>

<p>     03/05/1981, I.D.Howarth,  Version 1.
</p>

<p>     05/05/1981, I.D.Howarth,  Minibug fixed!
</p>

<p>     07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.
</p>

<p>     03/08/1981, S.Adams,      Interpolates collision strengths.
</p>

<p>     07/08/1981, S.Adams,      Input method changed.
</p>

<p>     19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical
                               filenames given to SA's data files.
</p>

<p>     08/1995, D.P.Ruffle, Changed input file format. Increased matrices.
</p>

<p>     02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD
                         modified such that matrix sizes (i.e. maximum
                         of Te and maximum no of levels) can now be cha
                         by modifying the parameters NDIM1, NDIM2 and N
                         in the Main program. EASY!
                         Now takes collision rates as well.
                         All variables are declared explicitly
                         Generate two extra files (ionpop.lis and ionra
                         of plain stream format for plotting.
</p>

<p>     06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.
                         Fixed readin bug for IBIG=2 case.
                         Now reads reformatted upsilons (easier to see
                         and the 0 0 0 data end is excluded for these c
                         The A values have a different format for IBIG=.
</p>

<p>     2006, B.Ercolano,   Converted to F90.
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.2.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::free">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::free<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::free()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set<span class="argument">, <a href="#collision::set:p:atom_ion">atom_ion</a></span><span class="argument">, <a href="#collision::set:k:level">level</a>=<span class="var">level</span></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set:p:atom_ion">atom_ion <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::set:k:level">level <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::calc_temperature">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::calc_temperature<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Plasma Diagnostics, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::calc_temperature(<span class="argument"><a href="#collision::calc_temperature:k:line_flux_ratio">line_flux_ratio</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_temperature:k:density">density</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_temperature:k:upper_levels">upper_levels</a>=<span class="var">string</span></span><span class="argument">, <a href="#collision::calc_temperature:k:lower_levels">lower_levels</a>=<span class="var">string</span></span><span class="argument"> [, <a href="#collision::calc_temperature:k:low_temperature">low_temperature</a>=<span class="var">float</span>]</span><span class="argument"> [, <a href="#collision::calc_temperature:k:high_temperature">high_temperature</a>=<span class="var">float</span>]</span><span class="argument"> [, <a href="#collision::calc_temperature:k:num_temperature">num_temperature</a>=<span class="var">integer</span>]</span><span class="argument"> [, <a href="#collision::calc_temperature:k:min_density">min_density</a>=<span class="var">float</span>]</span>)</code></p>

          
          <div ><p>     This function determines electron temperature from given
     flux intensity ratio for specified ion with upper level(s)
     lower level(s) by solving atomic level populations and
     line emissivities in statistical equilibrium
     for given electron density.
</p>

<p></p>

</div>
          

          
          <h3>Return value</h3>
            <div class="small"><p>    type=double. This function returns the electron temperature.
</p>

<p></p>

</div>
          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::calc_temperature:k:line_flux_ratio">line_flux_ratio <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                            flux intensity ratio
</p>

</dd>
              
              <dt id="collision::calc_temperature:k:density">density <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                            electron density
</p>

</dd>
              
              <dt id="collision::calc_temperature:k:upper_levels">upper_levels <span class="smaller">in required type=string </span></dt>
              <dd class="small"><p>                            upper atomic level(s) e.g '1,2/', '1,2,1,3/'
</p>

</dd>
              
              <dt id="collision::calc_temperature:k:lower_levels">lower_levels <span class="smaller">in required type=string </span></dt>
              <dd class="small"><p>                            lower atomic level(s) e.g '1,2/', '1,2,1,3/'
</p>

</dd>
              
              <dt id="collision::calc_temperature:k:low_temperature">low_temperature <span class="smaller">in optional type=float </span></dt>
              <dd class="small"><p>                            lower temperature range
</p>

</dd>
              
              <dt id="collision::calc_temperature:k:high_temperature">high_temperature <span class="smaller">in optional type=float </span></dt>
              <dd class="small"><p>                            upper temperature range
</p>

</dd>
              
              <dt id="collision::calc_temperature:k:num_temperature">num_temperature <span class="smaller">in optional type=integer </span></dt>
              <dd class="small"><p>                            number of the iteration step
</p>

</dd>
              
              <dt id="collision::calc_temperature:k:min_density">min_density <span class="smaller">in optional type=float </span></dt>
              <dd class="small"><p>                            lower density range
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> s2=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> s2-&gt;set,['s','ii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> upper_levels='1,2,1,3/'
<span class="code-prompt">IDL&gt;</span> lower_levels='1,5/'
<span class="code-prompt">IDL&gt;</span> density = double(2550)
<span class="code-prompt">IDL&gt;</span> line_flux_ratio=double(10.753)
<span class="code-prompt">IDL&gt;</span> temperature=s2-&gt;calc_temperature(line_flux_ratio=line_flux_ratio, density=density, $
<span class="code-prompt">IDL&gt;</span>   upper_levels=upper_levels, lower_levels=lower_levels)
<span class="code-prompt">IDL&gt;</span> print, "Electron Temperature:", temperature
<span class="code-output">   Electron Temperature:       7920.2865</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.
</p>

<p>     20/10/2016, A. Danehkar, Replaced str2int with strnumber.
</p>

<p>     20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with
          IDL function INTERPOL( /SPLINE).
</p>

<p>     20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function
                       LA_LINEAR_EQUATION.
</p>

<p>     15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)
           with IDL function LUDC & LUSOL.
</p>

<p>     19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with
                    SPL_INIT & SPL_INTERP.
</p>

<p>     20/11/2016, A. Danehkar, Made a new function calc_populations()
       for solving atomic level populations and separated it from
       calc_abundance(), calc_density() and calc_temperature().
</p>

<p>     10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data
                      input elj_data, omij_data, aij_data.
</p>

<p>     12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales
                        from calc_temperature().
</p>

<p>     27/02/2019, A. Danehkar, fix a bug in the atomic level assumption, and
                        use the simplified calc_populations() routine.
</p>

<p>     04/03/2019, A. Danehkar, use the get_omij_temp() routine.
</p>

<p>     24/05/2019, A. Danehkar, add the optional temperature range.
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

<p> FORTRAN HISTORY:
</p>

<p>     03/05/1981, I.D.Howarth,  Version 1.
</p>

<p>     05/05/1981, I.D.Howarth,  Minibug fixed!
</p>

<p>     07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.
</p>

<p>     03/08/1981, S.Adams,      Interpolates collision strengths.
</p>

<p>     07/08/1981, S.Adams,      Input method changed.
</p>

<p>     19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical
                               filenames given to SA's data files.
</p>

<p>     08/1995, D.P.Ruffle, Changed input file format. Increased matrices.
</p>

<p>     02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD
                         modified such that matrix sizes (i.e. maximum
                         of Te and maximum no of levels) can now be cha
                         by modifying the parameters NDIM1, NDIM2 and N
                         in the Main program. EASY!
                         Now takes collision rates as well.
                         All variables are declared explicitly
                         Generate two extra files (ionpop.lis and ionra
                         of plain stream format for plotting.
</p>

<p>     06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.
                         Fixed readin bug for IBIG=2 case.
                         Now reads reformatted upsilons (easier to see
                         and the 0 0 0 data end is excluded for these c
                         The A values have a different format for IBIG=.
</p>

<p>     2006, B.Ercolano,   Converted to F90.
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.2.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::calc_density">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::calc_density<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Plasma Diagnostics, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::calc_density(<span class="argument"><a href="#collision::calc_density:k:line_flux_ratio">line_flux_ratio</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_density:k:temperature">temperature</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_density:k:upper_levels">upper_levels</a>=<span class="var">string</span></span><span class="argument">, <a href="#collision::calc_density:k:lower_levels">lower_levels</a>=<span class="var">string</span></span><span class="argument"> [, <a href="#collision::calc_density:k:low_density">low_density</a>=<span class="var">float</span>]</span><span class="argument"> [, <a href="#collision::calc_density:k:high_density">high_density</a>=<span class="var">float</span>]</span><span class="argument"> [, <a href="#collision::calc_density:k:num_density">num_density</a>=<span class="var">integer</span>]</span><span class="argument"> [, <a href="#collision::calc_density:k:min_temperature">min_temperature</a>=<span class="var">float</span>]</span>)</code></p>

          
          <div ><p>     This function determines electron density from given
     flux intensity ratio for specified ion with upper level(s)
     lower level(s) by solving atomic level populations and
     line emissivities in statistical equilibrium
     for given electron temperature.
</p>

<p></p>

</div>
          

          
          <h3>Return value</h3>
            <div class="small"><p>    type=double. This function returns the electron density.
</p>

<p></p>

</div>
          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::calc_density:k:line_flux_ratio">line_flux_ratio <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                            flux intensity ratio
</p>

</dd>
              
              <dt id="collision::calc_density:k:temperature">temperature <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                            electron temperature
</p>

</dd>
              
              <dt id="collision::calc_density:k:upper_levels">upper_levels <span class="smaller">in required type=string </span></dt>
              <dd class="small"><p>                            upper atomic level(s) e.g '1,2/', '1,2,1,3/'
</p>

</dd>
              
              <dt id="collision::calc_density:k:lower_levels">lower_levels <span class="smaller">in required type=string </span></dt>
              <dd class="small"><p>                            lower atomic level(s) e.g '1,2/', '1,2,1,3/'
                            transition probabilities (Aij) data
</p>

</dd>
              
              <dt id="collision::calc_density:k:low_density">low_density <span class="smaller">in optional type=float </span></dt>
              <dd class="small"><p>                            lower density range
</p>

</dd>
              
              <dt id="collision::calc_density:k:high_density">high_density <span class="smaller">in optional type=float </span></dt>
              <dd class="small"><p>                            upper density range
</p>

</dd>
              
              <dt id="collision::calc_density:k:num_density">num_density <span class="smaller">in optional type=integer </span></dt>
              <dd class="small"><p>                            number of the iteration step
</p>

</dd>
              
              <dt id="collision::calc_density:k:min_temperature">min_temperature <span class="smaller">in optional type=float </span></dt>
              <dd class="small"><p>                            minimum temperature
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> s2=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> s2-&gt;set,['s','ii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> upper_levels='1,2/'
<span class="code-prompt">IDL&gt;</span> lower_levels='1,3/'
<span class="code-prompt">IDL&gt;</span> diagtype='D'
<span class="code-prompt">IDL&gt;</span> temperature=double(7000.0);
<span class="code-prompt">IDL&gt;</span> line_flux_ratio=double(1.506);
<span class="code-prompt">IDL&gt;</span> density=s2-&gt;calc_density(line_flux_ratio=line_flux_ratio, temperature=temperature, $
<span class="code-prompt">IDL&gt;</span>   upper_levels=upper_levels, lower_levels=lower_levels)
<span class="code-prompt">IDL&gt;</span> print, "Electron Density:", density
<span class="code-output">   Electron Density:       2312.6164</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.
</p>

<p>     20/10/2016, A. Danehkar, Replaced str2int with strnumber.
</p>

<p>     20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with
          IDL function INTERPOL( /SPLINE).
</p>

<p>     20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function
                       LA_LINEAR_EQUATION.
</p>

<p>     15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)
           with IDL function LUDC & LUSOL.
</p>

<p>     19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with
                    SPL_INIT & SPL_INTERP.
</p>

<p>     20/11/2016, A. Danehkar, Made a new function calc_populations()
       for solving atomic level populations and separated it from
       calc_abundance(), calc_density() and calc_temperature().
</p>

<p>     10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data
                      input elj_data, omij_data, aij_data.
</p>

<p>     12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales
                        from calc_density().
</p>

<p>     27/02/2019, A. Danehkar, fix a bug in the atomic level assumption, and
                        use the simplified calc_populations() routine.
</p>

<p>     04/03/2019, A. Danehkar, use the get_omij_temp() routine.
</p>

<p>     24/05/2019, A. Danehkar, add the optional density range.
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

<p> FORTRAN HISTORY:
</p>

<p>     03/05/1981, I.D.Howarth,  Version 1.
</p>

<p>     05/05/1981, I.D.Howarth,  Minibug fixed!
</p>

<p>     07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.
</p>

<p>     03/08/1981, S.Adams,      Interpolates collision strengths.
</p>

<p>     07/08/1981, S.Adams,      Input method changed.
</p>

<p>     19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical
                               filenames given to SA's data files.
</p>

<p>     08/1995, D.P.Ruffle, Changed input file format. Increased matrices.
</p>

<p>     02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD
                         modified such that matrix sizes (i.e. maximum
                         of Te and maximum no of levels) can now be cha
                         by modifying the parameters NDIM1, NDIM2 and N
                         in the Main program. EASY!
                         Now takes collision rates as well.
                         All variables are declared explicitly
                         Generate two extra files (ionpop.lis and ionra
                         of plain stream format for plotting.
</p>

<p>     06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.
                         Fixed readin bug for IBIG=2 case.
                         Now reads reformatted upsilons (easier to see
                         and the 0 0 0 data end is excluded for these c
                         The A values have a different format for IBIG=.
</p>

<p>     2006, B.Ercolano,   Converted to F90.
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.2.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::calc_populations">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::calc_populations<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::calc_populations(<span class="argument"><a href="#collision::calc_populations:k:temperature">temperature</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_populations:k:density">density</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_populations:k:eff_Omij">eff_Omij</a>=<span class="var">array/object</span></span><span class="argument">, <a href="#collision::calc_populations:k:level_num">level_num</a>=<span class="var">int</span></span><span class="argument">, <a href="#collision::calc_populations:k:irats">irats</a>=<span class="var">int</span></span>)</code></p>

          
          <div ><p>     This function solves atomic level populations in statistical equilibrium
     for given electron temperature and density.
</p>

<p></p>

</div>
          

          
          <h3>Return value</h3>
            <div class="small"><p>    type=array/object. This function returns the atomic level populations.
</p>

<p></p>

</div>
          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::calc_populations:k:temperature">temperature <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                     electron temperature
</p>

</dd>
              
              <dt id="collision::calc_populations:k:density">density <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                     electron density
</p>

</dd>
              
              <dt id="collision::calc_populations:k:eff_Omij">eff_Omij <span class="smaller">in type=array/object </span></dt>
              <dd class="small"><p>                     effective collision strengths (Omij_T) at given temperature
</p>

</dd>
              
              <dt id="collision::calc_populations:k:level_num">level_num <span class="smaller">in type=int </span></dt>
              <dd class="small"><p>                     Number of levels
</p>

</dd>
              
              <dt id="collision::calc_populations:k:irats">irats <span class="smaller">in type=int </span></dt>
              <dd class="small"><p>                     Else Coll. rates = tabulated values * 10 ** irats
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> s2=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> s2-&gt;set,['s','ii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> density = double(1000)
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0);
<span class="code-prompt">IDL&gt;</span> Nlj=s2-&gt;calc_populations(temperature=temperature, density=density)
<span class="code-prompt">IDL&gt;</span> print, 'Atomic Level Populations:', Nlj
<span class="code-output">   Atomic Level Populations:      0.96992796    0.0070037404     0.023062517   2.6594158e-06   3.1277593e-06</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.
</p>

<p>     20/10/2016, A. Danehkar, Replaced str2int with strnumber.
</p>

<p>     20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with
          IDL function INTERPOL( /SPLINE).
</p>

<p>     20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function
                       LA_LINEAR_EQUATION.
</p>

<p>     15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)
           with IDL function LUDC & LUSOL.
</p>

<p>     19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with
                    SPL_INIT & SPL_INTERP.
</p>

<p>     20/11/2016, A. Danehkar, Made a new function calc_populations()
       for solving atomic level populations and separated it from
       calc_abundance(), calc_density() and calc_temperature().
</p>

<p>     10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data
                      input elj_data, omij_data, aij_data.
</p>

<p>     12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales
                        from calc_populations().
</p>

<p>     27/02/2019, A. Danehkar, Simplify the calc_populations() routine
                        for external usage.
</p>

<p>     04/03/2019, A. Danehkar, Use the get_omij_temp() routine.
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

<p> FORTRAN HISTORY:
</p>

<p>     03/05/1981, I.D.Howarth,  Version 1.
</p>

<p>     05/05/1981, I.D.Howarth,  Minibug fixed!
</p>

<p>     07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.
</p>

<p>     03/08/1981, S.Adams,      Interpolates collision strengths.
</p>

<p>     07/08/1981, S.Adams,      Input method changed.
</p>

<p>     19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical
                               filenames given to SA's data files.
</p>

<p>     08/1995, D.P.Ruffle, Changed input file format. Increased matrices.
</p>

<p>     02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD
                         modified such that matrix sizes (i.e. maximum
                         of Te and maximum no of levels) can now be cha
                         by modifying the parameters NDIM1, NDIM2 and N
                         in the Main program. EASY!
                         Now takes collision rates as well.
                         All variables are declared explicitly
                         Generate two extra files (ionpop.lis and ionra
                         of plain stream format for plotting.
</p>

<p>     06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.
                         Fixed readin bug for IBIG=2 case.
                         Now reads reformatted upsilons (easier to see
                         and the 0 0 0 data end is excluded for these c
                         The A values have a different format for IBIG=.
</p>

<p>     2006, B.Ercolano,   Converted to F90.
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.0.6
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::calc_crit_density">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::calc_crit_density<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::calc_crit_density(<span class="argument"><a href="#collision::calc_crit_density:k:temperature">temperature</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_crit_density:k:level_num">level_num</a>=<span class="var">int</span></span><span class="argument">, <a href="#collision::calc_crit_density:k:irats">irats</a>=<span class="var">int</span></span>)</code></p>

          
          <div ><p>     This function calculates critical densities in statistical equilibrium
     for given electron temperature.
</p>

<p></p>

</div>
          

          
          <h3>Return value</h3>
            <div class="small"><p>    type=array/object. This function returns the critical densities.
</p>

<p></p>

</div>
          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::calc_crit_density:k:temperature">temperature <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                     electron temperature
</p>

</dd>
              
              <dt id="collision::calc_crit_density:k:level_num">level_num <span class="smaller">in type=int </span></dt>
              <dd class="small"><p>                     Number of levels
</p>

</dd>
              
              <dt id="collision::calc_crit_density:k:irats">irats <span class="smaller">in type=int </span></dt>
              <dd class="small"><p>                     Else Coll. rates = tabulated values * 10 ** irats
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> s2=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> s2-&gt;set,['s','ii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> N_crit=s2-&gt;calc_crit_density(temperature=temperature)
<span class="code-prompt">IDL&gt;</span> print, 'Critical Densities:', N_crit
<span class="code-output">   Critical Densities:       0.0000000       5007.8396       1732.8414       1072685.0       2220758.1</span>
</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.
</p>

<p>     20/10/2016, A. Danehkar, Replaced str2int with strnumber.
</p>

<p>     20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with
          IDL function INTERPOL( /SPLINE).
</p>

<p>     20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function
                       LA_LINEAR_EQUATION.
</p>

<p>     15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)
           with IDL function LUDC & LUSOL.
</p>

<p>     19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with
                    SPL_INIT & SPL_INTERP.
</p>

<p>     20/11/2016, A. Danehkar, Made a new function calc_populations()
       for solving atomic level populations and separated it from
       calc_abundance(), calc_density() and calc_temperature().
</p>

<p>     10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data
                      input elj_data, omij_data, aij_data.
</p>

<p>     12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales
                        from calc_populations().
</p>

<p>     27/02/2019, A. Danehkar, simplify the calc_populations() routine
                        for external usage.
</p>

<p>     01/03/2019, A. Danehkar, create the calc_crit_density() routine
                        from the calc_populations() routine.
</p>

<p>     04/03/2019, A. Danehkar, use the get_omij_temp() routine.
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

<p> FORTRAN HISTORY:
</p>

<p>     03/05/1981, I.D.Howarth,  Version 1.
</p>

<p>     05/05/1981, I.D.Howarth,  Minibug fixed!
</p>

<p>     07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.
</p>

<p>     03/08/1981, S.Adams,      Interpolates collision strengths.
</p>

<p>     07/08/1981, S.Adams,      Input method changed.
</p>

<p>     19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical
                               filenames given to SA's data files.
</p>

<p>     08/1995, D.P.Ruffle, Changed input file format. Increased matrices.
</p>

<p>     02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD
                         modified such that matrix sizes (i.e. maximum
                         of Te and maximum no of levels) can now be cha
                         by modifying the parameters NDIM1, NDIM2 and N
                         in the Main program. EASY!
                         Now takes collision rates as well.
                         All variables are declared explicitly
                         Generate two extra files (ionpop.lis and ionra
                         of plain stream format for plotting.
</p>

<p>     06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.
                         Fixed readin bug for IBIG=2 case.
                         Now reads reformatted upsilons (easier to see
                         and the 0 0 0 data end is excluded for these c
                         The A values have a different format for IBIG=.
</p>

<p>     2006, B.Ercolano,   Converted to F90.
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.2.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::calc_emissivity">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::calc_emissivity<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Abundance Analysis, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::calc_emissivity(<span class="argument"><a href="#collision::calc_emissivity:k:temperature">temperature</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_emissivity:k:density">density</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_emissivity:k:atomic_levels">atomic_levels</a>=<span class="var">string</span></span>)</code></p>

          
          <div ><p>     This function calculates line emissivities for specified ion with level(s) by
     solving atomic level populations and in statistical equilibrium
     for given electron density and temperature.
</p>

<p></p>

</div>
          

          
          <h3>Return value</h3>
            <div class="small"><p>    type=double. This function returns the line emissivity.
</p>

<p></p>

</div>
          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::calc_emissivity:k:temperature">temperature <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                         electron temperature
</p>

</dd>
              
              <dt id="collision::calc_emissivity:k:density">density <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                         electron density
</p>

</dd>
              
              <dt id="collision::calc_emissivity:k:atomic_levels">atomic_levels <span class="smaller">required type=string </span></dt>
              <dd class="small"><p>                         level(s) e.g '1,2/', '1,2,1,3/'
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> o3=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> o3-&gt;set,['o','iii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> levels5007='3,4/'
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> density=double(5000.0)
<span class="code-prompt">IDL&gt;</span> iobs5007=double(1200.0)
<span class="code-prompt">IDL&gt;</span> Abb5007=double(0.0)
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> emis=o3-&gt;calc_emissivity(temperature=temperature, density=density, $
<span class="code-prompt">IDL&gt;</span>   atomic_levels=levels5007)
<span class="code-prompt">IDL&gt;</span> print, 'Emissivity(O III 5007):', emis
<span class="code-output">   Emissivity(O III 5007):   3.6041012e-21</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.
</p>

<p>     20/10/2016, A. Danehkar, Replaced str2int with strnumber.
</p>

<p>     20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with
          IDL function INTERPOL( /SPLINE).
</p>

<p>     20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function
                       LA_LINEAR_EQUATION.
</p>

<p>     15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)
           with IDL function LUDC & LUSOL.
</p>

<p>     19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with
                    SPL_INIT & SPL_INTERP.
</p>

<p>     20/11/2016, A. Danehkar, Made a new function calc_populations()
       for solving atomic level populations and separated it from
       calc_abundance(), calc_density() and calc_temperature().
</p>

<p>     21/11/2016, A. Danehkar, Made a new function calc_emissivity()
                      for calculating line emissivities and separated it
                      from calc_abundance().
</p>

<p>     10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data
                      input elj_data, omij_data, aij_data.
</p>

<p>     12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales
                        from calc_emissivity().
</p>

<p>     27/06/2019, A. Danehkar, use the simplified calc_populations() routine.
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

<p> FORTRAN HISTORY:
</p>

<p>     03/05/1981, I.D.Howarth,  Version 1.
</p>

<p>     05/05/1981, I.D.Howarth,  Minibug fixed!
</p>

<p>     07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.
</p>

<p>     03/08/1981, S.Adams,      Interpolates collision strengths.
</p>

<p>     07/08/1981, S.Adams,      Input method changed.
</p>

<p>     19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical
                               filenames given to SA's data files.
</p>

<p>     08/1995, D.P.Ruffle, Changed input file format. Increased matrices.
</p>

<p>     02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD
                         modified such that matrix sizes (i.e. maximum
                         of Te and maximum no of levels) can now be cha
                         by modifying the parameters NDIM1, NDIM2 and N
                         in the Main program. EASY!
                         Now takes collision rates as well.
                         All variables are declared explicitly
                         Generate two extra files (ionpop.lis and ionra
                         of plain stream format for plotting.
</p>

<p>     06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.
                         Fixed readin bug for IBIG=2 case.
                         Now reads reformatted upsilons (easier to see
                         and the 0 0 0 data end is excluded for these c
                         The A values have a different format for IBIG=.
</p>

<p>     2006, B.Ercolano,   Converted to F90.
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.2.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::calc_abundance">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::calc_abundance<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Abundance Analysis, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::calc_abundance(<span class="argument"><a href="#collision::calc_abundance:k:temperature">temperature</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_abundance:k:density">density</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_abundance:k:line_flux">line_flux</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::calc_abundance:k:atomic_levels">atomic_levels</a>=<span class="var">string</span></span>)</code></p>

          
          <div ><p>     This function determines the ionic abundance from the observed
     flux intensity for specified ion with level(s)
     by solving atomic level populations and
     line emissivities in statistical equilibrium
     for given electron density and temperature.
</p>

<p></p>

</div>
          

          
          <h3>Return value</h3>
            <div class="small"><p>    type=double. This function returns the ionic abundanc.
</p>

<p></p>

</div>
          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::calc_abundance:k:temperature">temperature <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                         electron temperature
</p>

</dd>
              
              <dt id="collision::calc_abundance:k:density">density <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                         electron density
</p>

</dd>
              
              <dt id="collision::calc_abundance:k:line_flux">line_flux <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                         line flux intensity
</p>

</dd>
              
              <dt id="collision::calc_abundance:k:atomic_levels">atomic_levels <span class="smaller">in required type=string </span></dt>
              <dd class="small"><p>                         level(s) e.g '1,2/', '1,2,1,3/'
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> o3=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> o3-&gt;set,['o','iii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> levels5007='3,4/'
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> density=double(5000.0)
<span class="code-prompt">IDL&gt;</span> iobs5007=double(1200.0)
<span class="code-prompt">IDL&gt;</span> Abb5007=double(0.0)
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> Abb5007=o3-&gt;calc_abundance(temperature=temperature, density=density, $
<span class="code-prompt">IDL&gt;</span>   line_flux=iobs5007, atomic_levels=levels5007)
<span class="code-prompt">IDL&gt;</span> print, 'N(O^2+)/N(H+):', Abb5007
<span class="code-output">   N(O^2+)/N(H+):   0.00041256231</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.
</p>

<p>     20/10/2016, A. Danehkar, Replaced str2int with strnumber.
</p>

<p>     20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with
          IDL function INTERPOL( /SPLINE).
</p>

<p>     20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function
                       LA_LINEAR_EQUATION.
</p>

<p>     15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)
           with IDL function LUDC & LUSOL.
</p>

<p>     19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with
                    SPL_INIT & SPL_INTERP.
</p>

<p>     20/11/2016, A. Danehkar, Made a new function calc_populations()
       for solving atomic level populations and separated it from
       calc_abundance(), calc_density() and calc_temperature().
</p>

<p>     21/11/2016, A. Danehkar, Made a new function calc_emissivity()
                      for calculating line emissivities and separated it
                      from calc_abundance().
</p>

<p>     10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data
                      input elj_data, omij_data, aij_data.
</p>

<p>     12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales
                        from calc_abundance().
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

<p> FORTRAN HISTORY:
</p>

<p>     03/05/1981, I.D.Howarth,  Version 1.
</p>

<p>     05/05/1981, I.D.Howarth,  Minibug fixed!
</p>

<p>     07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.
</p>

<p>     03/08/1981, S.Adams,      Interpolates collision strengths.
</p>

<p>     07/08/1981, S.Adams,      Input method changed.
</p>

<p>     19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical
                               filenames given to SA's data files.
</p>

<p>     08/1995, D.P.Ruffle, Changed input file format. Increased matrices.
</p>

<p>     02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD
                         modified such that matrix sizes (i.e. maximum
                         of Te and maximum no of levels) can now be cha
                         by modifying the parameters NDIM1, NDIM2 and N
                         in the Main program. EASY!
                         Now takes collision rates as well.
                         All variables are declared explicitly
                         Generate two extra files (ionpop.lis and ionra
                         of plain stream format for plotting.
</p>

<p>     06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.
                         Fixed readin bug for IBIG=2 case.
                         Now reads reformatted upsilons (easier to see
                         and the 0 0 0 data end is excluded for these c
                         The A values have a different format for IBIG=.
</p>

<p>     2006, B.Ercolano,   Converted to F90.
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.2.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::print_ionic">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::print_ionic<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
          

          <p class="syntax"><code>collision::print_ionic<span class="argument">, <a href="#collision::print_ionic:k:temperature">temperature</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::print_ionic:k:density">density</a>=<span class="var">float</span></span><span class="argument">, /<a href="#collision::print_ionic:k:printEmissivity">printEmissivity</a></span><span class="argument">, /<a href="#collision::print_ionic:k:printPopulations">printPopulations</a></span><span class="argument">, /<a href="#collision::print_ionic:k:printCritDensity">printCritDensity</a></span></code></p>

          
          <div ><p>    This function prints the atom's transitions information,
    atomic level populations, critical densities, and emissivities
    for given temperature and density.
</p>

<p></p>

</div>
          

          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::print_ionic:k:temperature">temperature <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                       electron temperature
</p>

</dd>
              
              <dt id="collision::print_ionic:k:density">density <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                       electron density
</p>

</dd>
              
              <dt id="collision::print_ionic:k:printEmissivity">printEmissivity <span class="smaller">in type=boolean </span></dt>
              <dd class="small"><p>                          Set for printing Emissivities
</p>

</dd>
              
              <dt id="collision::print_ionic:k:printPopulations">printPopulations <span class="smaller">in type=boolean </span></dt>
              <dd class="small"><p>                          Set for printing Populations
</p>

</dd>
              
              <dt id="collision::print_ionic:k:printCritDensity">printCritDensity <span class="smaller">in type=boolean </span></dt>
              <dd class="small"><p>                          Set for printing Critical Densities
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> o3=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> o3-&gt;set,['o','iii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> levels5007='3,4/'
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> density=double(5000.0)
<span class="code-prompt">IDL&gt;</span> iobs5007=double(1200.0)
<span class="code-prompt">IDL&gt;</span> Abb5007=double(0.0)
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> o3-&gt;print_ionic, temperature=temperature, density=density
<span class="code-output">   Temperature =   10000.0 K</span>
<span class="code-output">   Density =    5000.0 cm-3</span>

<span class="code-output">   Level    Populations   Critical Densities</span>
<span class="code-output">   Level 1:   1.556E-01   0.000E+00</span>
<span class="code-output">   Level 2:   4.269E-01   4.908E+02</span>
<span class="code-output">   Level 3:   4.172E-01   3.419E+03</span>
<span class="code-output">   Level 4:   2.221E-04   6.853E+05</span>
<span class="code-output">   Level 5:   1.522E-08   2.547E+07</span>

<span class="code-output">   2.597E-05</span>
<span class="code-output">   88.34um</span>
<span class="code-output">   (2--&gt;1)</span>
<span class="code-output">   4.986E-23</span>

<span class="code-output">   0.000E+00   9.632E-05</span>
<span class="code-output">   32.66um      51.81um</span>
<span class="code-output">   (3--&gt;1)     (3--&gt;2)</span>
<span class="code-output">   0.000E+00   3.081E-22</span>

<span class="code-output">   2.322E-06   6.791E-03   2.046E-02</span>
<span class="code-output">   4932.60A    4960.29A    5008.24A</span>
<span class="code-output">   (4--&gt;1)     (4--&gt;2)     (4--&gt;3)</span>
<span class="code-output">   4.153E-25   1.208E-21   3.604E-21</span>

<span class="code-output">   0.000E+00   2.255E-01   6.998E-04   1.685E+00</span>
<span class="code-output">   2315.58A    2321.67A    2332.12A    4364.45A</span>
<span class="code-output">   (5--&gt;1)     (5--&gt;2)     (5--&gt;3)     (5--&gt;4)</span>
<span class="code-output">   0.000E+00   5.875E-24   1.815E-26   2.335E-23</span>

<span class="code-output">   H-beta emissivity: 1.239E-25 N(H+) Ne  [erg/s]</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     04/03/2019, A. Danehkar, create the print_ionic() routine.
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.2.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_omij_temp">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_omij_temp<span class="routine-attributes"></span></h2>

          
          <p class="small categories">Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
          

          <p class="syntax"><code><span class="var">result</span> = collision::get_omij_temp(<span class="argument"><a href="#collision::get_omij_temp:k:temperature">temperature</a>=<span class="var">float</span></span><span class="argument">, <a href="#collision::get_omij_temp:k:level_num">level_num</a>=<span class="var">int</span></span><span class="argument">, <a href="#collision::get_omij_temp:k:irats">irats</a>=<span class="var">int</span></span>)</code></p>

          
          <div ><p>     This function derives the effective collision strengths (Omij_T) from
     the collision strengths (omega_ij) data for the given temperature.
</p>

<p></p>

</div>
          

          
          <h3>Return value</h3>
            <div class="small"><p>    type=array/object. This function returns the effective collision strengths (Omij_T).
</p>

<p></p>

</div>
          

          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="collision::get_omij_temp:k:temperature">temperature <span class="smaller">in required type=float </span></dt>
              <dd class="small"><p>                     electron temperature
</p>

</dd>
              
              <dt id="collision::get_omij_temp:k:level_num">level_num <span class="smaller">in type=int </span></dt>
              <dd class="small"><p>                     Number of levels
</p>

</dd>
              
              <dt id="collision::get_omij_temp:k:irats">irats <span class="smaller">in type=int </span></dt>
              <dd class="small"><p>                     Else Coll. rates = tabulated values * 10 ** irats
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>    For example:
<div><div><code class="listing"><span class="code-prompt">IDL&gt;</span> s2=obj_new('collision')
<span class="code-prompt">IDL&gt;</span> s2-&gt;set,['s','ii']
<span class="code-prompt">IDL&gt;</span>
<span class="code-prompt">IDL&gt;</span> temperature=double(10000.0)
<span class="code-prompt">IDL&gt;</span> Omij_T=s2-&gt;get_omij_temp(temperature=temperature)
<span class="code-prompt">IDL&gt;</span> print, 'Effective Collision Strengths: '
<span class="code-prompt">IDL&gt;</span> print, Omij_T
<span class="code-output">   Effective Collision Strengths:</span>
<span class="code-output">   0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   2.7800000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   4.1600000       7.4600000       0.0000000       0.0000000       0.0000000</span>
<span class="code-output">   1.1700000       1.8000000       2.2000000       0.0000000       0.0000000</span>
<span class="code-output">   2.3500000       3.0000000       4.9900000       2.7100000       0.0000000</span>

</code></div></div></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>   Ashkbiz Danehkar
</p>

<p></p>

</dd>
              

              
                <dt>Copyright:</dt>
                <dd><p>   This library is released under a GNU General Public License.
</p>

<p></p>

</dd>
              

              
                <dt>History:</dt>
                <dd><p>     04/03/2019, A. Danehkar, create the get_omij_temp() routine.
</p>

<p>     08/07/2019, A. Danehkar, Move to object-oriented programming (OOP).
</p>

</dd>
              

              
                <dt>Version:</dt>
                <dd><p>   0.3.0
</p>

<p></p>

</dd>
              
            </dl>
          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set_level_num">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set_level_num<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set_level_num<span class="argument">, <a href="#collision::set_level_num:p:level_num">level_num</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set_level_num:p:level_num">level_num <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_level_num">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_level_num<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::get_level_num()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set_data_dir">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set_data_dir<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set_data_dir<span class="argument">, <a href="#collision::set_data_dir:p:data_dir">data_dir</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set_data_dir:p:data_dir">data_dir <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_data_dir">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_data_dir<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::get_data_dir()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set_data_rc_dir">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set_data_rc_dir<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set_data_rc_dir<span class="argument">, <a href="#collision::set_data_rc_dir:p:data_rc_dir">data_rc_dir</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set_data_rc_dir:p:data_rc_dir">data_rc_dir <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_data_rc_dir">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_data_rc_dir<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::get_data_rc_dir()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set_Atom_Elj_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set_Atom_Elj_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set_Atom_Elj_file<span class="argument">, <a href="#collision::set_Atom_Elj_file:p:Atom_Elj_file">Atom_Elj_file</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set_Atom_Elj_file:p:Atom_Elj_file">Atom_Elj_file <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_Atom_Elj_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_Atom_Elj_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::get_Atom_Elj_file()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set_Atom_Omij_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set_Atom_Omij_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set_Atom_Omij_file<span class="argument">, <a href="#collision::set_Atom_Omij_file:p:Atom_Omij_file">Atom_Omij_file</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set_Atom_Omij_file:p:Atom_Omij_file">Atom_Omij_file <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_Atom_Omij_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_Atom_Omij_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::get_Atom_Omij_file()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set_Atom_Aij_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set_Atom_Aij_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set_Atom_Aij_file<span class="argument">, <a href="#collision::set_Atom_Aij_file:p:Atom_Aij_file">Atom_Aij_file</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set_Atom_Aij_file:p:Atom_Aij_file">Atom_Aij_file <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_Atom_Aij_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_Atom_Aij_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::get_Atom_Aij_file()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::set_Atom_RC_SH95_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::set_Atom_RC_SH95_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision::set_Atom_RC_SH95_file<span class="argument">, <a href="#collision::set_Atom_RC_SH95_file:p:Atom_RC_SH95_file">Atom_RC_SH95_file</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="collision::set_Atom_RC_SH95_file:p:Atom_RC_SH95_file">Atom_RC_SH95_file <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision::get_Atom_RC_SH95_file">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision::get_Atom_RC_SH95_file<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = collision::get_Atom_RC_SH95_file()</code></p>

          

          

          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="collision__define">
          <h2 class="routine-name"><a href="#root" class="top">top</a> collision__define<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>collision__define</code></p>

          

          

          

          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Wed Jul 10 17:47:06 2019</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>182</td>
          </tr>

          
          <tr>
            <td class="name">Docformat:</td>
            <td>rst rst</td>
          </tr>
          
        </table>
      </div>

      <div style="border: 1px dotted #9090C0; background: #D0D0FF; margin: 1em 0; padding: 0.5em 1.5em;">
  <p class="smaller">Documentation for the proEQUIB IDL Library. See <a href="https://github.com/equib/proEQUIB" target="_top">the GitHub repository</a> for more information about proEQUIB.</p>
</div>
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.6.2 on Wed Jul 10 18:24:45 2019</td>
          <td class="right"><a target="_top" href="http://github.com/mgalloy/idldoc">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>